---
title: Ian Grigg：三式记账法
data: "2021/2/27 17:21:30"
excerpt: "带有数字签名的收据，作为金融密码学的一项创新，向传统的、可疑的复式记账提出了挑战。但它们之间更多的不是竞争关系，把两者结合在一起能创造一个更强壮的系统。将会计的使用扩展到广泛的数字现金领域，会使交互的三个角色每个都在本地留下三个条目，结果就是我所谓的“三式记账法”。"
tags:
- Ian Grigg
- 账本
---

*标题：Triple Entry Accounting*

*作者：Ian Grigg*

*来源：https://nakamotoinstitute.org/triple-entry-accounting/*

*译者：闵敏 & 阿剑（hongji@ethfans.org）*

---

## 摘要

带有数字签名的收据，作为金融密码学的一项创新，向传统的、可疑的复式记账提出了挑战。但它们之间更多的不是竞争关系，把两者结合在一起能创造一个更强壮的系统。将会计的使用扩展到广泛的数字现金领域，会使交互的三个角色每个都在本地留下三个条目，结果就是我所谓的 *三式记账法*。

这样的系统为激进的（aggressive）用法和用户创建了无懈可击（bullet proof）的会计系统。它不仅通过提供可靠并且是支撑性的会计工作降低了成本，也让更健壮的治理成为可能，因为它会积极影响未来对公司会计和公共事业会计的需求。

## 引言

本论文将金融密码学上的创新（比如带签名的收据（Signed Receipt））和标准的会计技术（复式记账（double entry bookkeeping））结合在了一起。

本文的第一章会提供一些简要的背景资料来解释复式记账的重要性；这一章是为技术人员准备的，专业的会计人员可以跳过这一章。第二章会解释带签名的收据是如何产生的，以及为什么说它挑战了复试记账方法。

第三章会将前两章的内容整合在一起。“结论” 一章则试图预测这项技术对治理（Governance）的广泛影响。

### 致谢

本文从  Graeme Burnett 和 Todd Boyle 的评论 [<sup>1</sup>](#note-1) 中受益良多。

## 会计学简史

从今天来看，会计学（accounting），或者说会计工作（accountancy）可以追溯到文字的起源；现今发现最早的文字，被解释成记录动物和留存食物数量的简单列表。大约 5000 年前，生活在美索不达米亚地区（Mesopotamia）的苏美尔人（Sumerians），使用楔形文字（Cuneiform）或者楔形的标记形成了 60 进制的数学（有些概念如分、秒、平方和角度，我们至今仍在使用）。而之所以要有数学和书写记录，很可能是因为在早期社会中，他们需要记录基本的资产数量和食物数量，而且需要加减数字。

### **单式记账**

单式簿记法，是我们每个人自己记账会用的方法：做一张表格，用一个一个的条目来记录各种资产。再高级一点的技巧，就是分别制作许多不同的列表。每一个列表或者说 “账簿”，都代表一个类目（一种东西），而每一个条目都会记录一个日期，加减的数量，可能还会加一些备注。要转移资产的时候，你就要从一个列表中划掉它，然后写到另一个列表中。

单式记账非常简单，但也很容易出错。最糟糕的问题是，错误可能是偶然出现的，因此很难找出并修正；也有可能是有意为之。因为每一个条目都是独立的，每一个列表之间都没有关联，所以根本没有办法阻止一个恶意的雇员在某个列表上增加条目；即使被发现了，也很难证明这到底是无心之失，还是别有用心。

基于单式簿记的会计也大大限制了簿记人员的范围。比如，某些时代，只有企业所有者的家人，或者其奴隶，才被信任可以保管账簿，由此导致了对家庭和奴隶制作为企业形态的支撑性影响。

> 译者注：单式记账的例子是你日常给自己记的流水账：
>
> - 12 月 29 日，- 100，买菜；
> - 12 月 30 日，+ 500，收到货款


### **复式记账**

[复式簿记法](http://en.wikipedia.org/wiki/Double-entry_book-keeping)为会计系统加入了一个重要的属性：能够用明确的策略来定位错误及消除错误。更棒的是（它有一个副作用），对无论是 *意外* 还是 *欺诈*，复式记账都有明显的防火墙作用。

这种属性是由复式记账在技术上的三个特征塑造出来的：（1）将所有的账簿都分成两栏（或者说两组），分别称为 “资产” 和 “负债”；（2）重复的 *双条目* 记账所带来的冗余：每一栏的每一条记录，都在另一栏有一条对应的记录；（3）*资产负债表等式*，即资产栏所有条目的总和必定等于负债栏所有条目的总和。

因此，一条正确的记录必定会有对应的账本，而其对应账本的条目必定存在于另一栏中。簿记人员可能出于恶意而加入一条错误的记录，但该记录必须指出其对应的账簿，否则，作为一条不完整的条目就大可删去。如果它确实指出了对应的账簿，那就很容易确认，或者检查之后基于正确的含义重新创建一条正确的条目，也就终止了反复跳转的循环。

以前，单式记账的账本中，作弊者只需选择一列，把自己想要的数量加入其中。但是在复式记账的账本中，所有的数目都必须有来源；如果一个数字是无中生有的，那就可以当作意外的错误，直接删去；而如果它有具体的来源，那就可以定位出这个出处了。这样一来，作弊也会留下线索，而对照另一本账本就能揭示其中的因果，因为，那本账本中的价值也必定是从某个地方来的。

这些思辨引申出了一种审计策略。首先，保证所有条目都是完整的，即都有对应的条目；其次，保证所有的价值转移都是准确的。这个简单的策略会产生一份事务的记录，使得会计的工作得以进行，而且无法轻易在账本中藏匿错误。

> 译者注：在现代，我们用下述的记录来运行复式记账：
>
> 12 月 31 日，借：零件，100；贷：库存现金，100；（花费 100 元买入零件）
>
> 但作者在上文中的意思可能基于一种形式上不同但实质类似的方法：创建两个账本，一个记录现金，一个记录零件（的价值），（每次交易都）在两个账本中分别留下一条记录，因此，一个条文必定指向另一个账本，所有的数目都必定有来源。

### **复式记账和企业，到底哪个先出现？**

复式记账是商业领域最为重大的发现之一，其重要性说之不尽。历史学家认为，复式记账大概是在公元 1300 年发明的，虽然有人认为早在希腊帝国时期就存在某种形式的复式记账。当前发现最强有力的证据是一份 1494 年的数学论文，作者是威尼斯的教士 [Luca Pacioli](http://www-groups.dcs.st-andrews.ac.uk/~history/Mathematicians/Pacioli.html) [<sup>2</sup>](#note-2)。在他的论文中，Pacioli 记录了许多标准化的技术，其中包括了专论会计的一个章节。在很长一段时间里，该论文都是复式记账的基础文本。

同时，复式记账也是随着由威尼斯的商人开创的现代形式企业的兴起而兴起的。历史学家们也在辩论，到底复式记账是新型的合资公司急剧膨胀的会计需求的产物（当时这类企业正围绕着城市国家如威尼斯的扩张而遍地开花），还是复式记账赋能了商事的扩张。

经验使我们倾向于赋能这一方的见解。我以电子货币发行者的经验为例。我们部署的第一个系统是一个单式记账系统。即使编码很严格，其错误率也很高，账户还没超过 20 个，会计错误就开始潜滋暗长，系统也开始失去凝聚力。这在初步测试的几周内就发生了，根本就没能实际派上用场。而替代的复式记账系统在 1996 年上半年推出后，迄今从未丢失过一笔事务（虽然也有相当惊险的时候 [<sup>3</sup>](#note-3)）。

类似地，荷兰的 DigiCash BV 公司也为美国的一家银行引入了一套初步的电子现金系统。在测试期间，最初设计的单式记账系统就不得不换成复式记账系统，原因完全相同 —— 错误暗生，让基于数字现金系统的会计工作变得不可靠。

另一个主要电子货币系统在单式记账系统的基础上存活了很多年。但是，那家公司也知道，这只是侥幸。某个黑客成功找到一个漏洞时，TA 一夜之间就膨胀出了几百万美金。这个金额太大，完全超出了当时该银行的合同价值；攻击导致银行的资产负债表出现了夸张的扭曲，包括使之陷入了违反用户合同、面临用户挤兑的风险。幸运的是，那名黑客只是把创造出来的价值存入了一个网络游戏的账户中，而该游戏很快就失败了，所以这些数字也能清零，没有曝光，也没有丑闻。

至少在笔者看来，单式记账无法支撑比家庭更复杂的企业。所以，我主张，复杂企业若要演化出来，就得以复式记账的出现为前提。

### **在计算机上快速实现复式记账**

复式记账一直是计算机会计系统的基石。检测、厘清和纠正错误的能力，对计算机来说比对人类更重要，因为计算机运行时，使用人力干预是很奢侈的；用户与计算机数据的距离，比会计人员离 TA 的账本上的墨水印的距离要远得多。

如何实现复式记账是一个元问题。

计算机科学引入了诸如 *事务*（transaction）这样的概念，来表示满足 *原子性、一致性、独立性和持久性* （简称为 ACID）的工作单元。对计算机科学家来说，核心的问题是：如何能够先为资产端加入一条记录，然后为负债段加入一条记录，并且不会中途崩溃；或者更糟糕地，在一条事务还没处理完成之时，就有另一条事务插队。一台计算机可能要管理几百万条记录，而且即使概率很小也总有可能出错；再加上，最终出错时，计算机并不善于处理这种性质的错误；想到了这些，你会对这个问题更有感觉。

大多数时候，这些概念都可以简化为 “如何实现复式记账法”。鉴于这个问题在文献中已经有完备的回答了，我们在此就不赘述了。

## （稍微复杂一点的）带签名收据简史

金融密码学的最新进展给复式记账的概念提出了挑战。数字签名能够相当可靠地创建一条记录，至少能满足上述的 ACID 要求。我们可以依赖一个数字签名来保证一条记录的安全，记录的数据发生任何更改，都会导致对应的签名无法通过验证程序。

如果我们可以假设，每一条记录在一开始创建的时候都是正确，那么事后我们就可以（靠数字签名）揭露错误，无论错误是偶然出错还是有心欺诈。（计算机很少会偶然出错；而且，真的出错的时候，一般来说也更像打翻墨水瓶（把许多数据搞坏），而不会精确地只改动几个数字）。如此，对记录的任何更改，只要有会计或者语言上的含义，都几乎可以确定是欺诈；数字签名，就可以做到这样的效果。

### **数字签名和电子现金**

数字签名给了我们一种特定的属性，那就是证明：

“在特定的时间点，某条信息被签名计算机看到了，并且打上了标记。”

这一属性有多种多样的变形，既有更弱的也有更严格的。举个例子，带有 *纠缠*（entanglement）的 *消息摘要*（message digests）就构成了一种简单但有效的签名形式，而 *公钥密码学* 使签名可以有额外的属性：签名者持有私钥，而验证者只需持有签名者的公钥 [<sup>4</sup>](#note-4)。也有很多方法来攻击这种基本属性。在本文中，我不会详细比较这些数量，我仅仅假设基本的属性就是：数字签名是证明一台计算机在某个时间点看到了某条消息的可靠标记。

数字签名代表了一种新的创建可靠、可信记录的办法，可以用来建构会计系统。一开始，有人提出了一种叫做 “盲签名”（blinded signature） 的变种，来支持电子现金系统 [<sup>5</sup>](#note-5) （译者注：就是密码朋克 David Chaum 提出的 DigiCash）。后来，有人提出，*凭证*（certificates）可以像产权或者合约那样流通，就跟以前的股份凭证的流通方式相同，因此可以替代集中式的会计系统 [<sup>6</sup>](#note-6)。这些想法都以金融密码学为道路、为桥梁。不过，虽然他们展示了如何明确地验证每一笔事务，他们没能把数字签名置于会计和治理的整体框架之中。一个必要的步骤是像复试记账法所暗示的那样，加入冗余，以保护事务的参与者和系统的运营者免疫欺诈。

### **收据（Receipt）的基本作用**

互联网的特性、密码学的功能和治理的需要，将我们引向了 *带签名收据* [<sup>7</sup>](#note-7) 技术的开发。为了讲清楚这个概念，我们先假设一个简单的、三方参与的支付系统，而且每一方都持有一把授权密钥，可以用来为他们发出的指令生成数字签名。为方便起见，我们以 Alice、Bob 和 Ivan 来分别指称两个交易者和一个数字化价值的发行者（管理员）。

![1](https://upyun-assets.ethfans.org/uploads/photo/image/4b500b9f861343bd863f0ce681d04ba2.png)

当 Alice 想要给 Bob 转让由 Ivan 管理的一些价值单位或者合约时，她就写出自己想要的支付指令，并用自己的密钥生成数字签名，就跟现实世界里签发支票的过程类似。她把支付事务的数据和数字签名一起发给 Ivan 的服务器。假设 Ivan 同意了，并在内部的账本中完成了转移，然后他就发出一条收据，并用自己的签名密钥签上数字签名。再然后，（作为这套协议的一个重要部分），Ivan 通过可靠的方式，将这条带有数字签名的收据发给 Alice 和 Bob，然后 Alice 和 Bob 就可以分别更新自己的内部账本了。

### **收据即事务**

我们的数字化价值系统（digital value）想要尽可能地消除风险。而实际上，这个要求只是衍生自另一个更高层次的要求：能够尽可能高效地发行价值（issuance of value）。数字化发行的效率基本上是由支撑成本（support cost）决定的，而支撑成本的一大决定因素又是欺诈和盗窃的成本。

所有以合理的成本实现的高效数字化价值系统，都持续面临着一种风险，就是 *内部的欺诈*。在我们这个有很多用户、但只有一个集中式服务器的模型中，数字化价值单位的发行者（作为合同的签字人）以及任何治理合伙人（例如服务器的运营者），都有可能制造内部欺诈。过去几年中出现的时间，比如共同基金的丑闻和 “股票门” 事件，就是我们所面临风险的典型案例。

![2](https://upyun-assets.ethfans.org/uploads/photo/image/bbcb8ea9847442b184f5930e22ffba06.png)

为了解决内部欺诈的风险，书面的收据一直被当成是主要的证据来源。现在出门买东西的人大多都已经忘记了：在普通的零售买卖中，书面收据的作用不是允许消费者退货和投诉，而是让客户参与一项书面的协议，让店员老实地保管这些钱。好的顾客会注意到店员的欺诈，并提醒店老板当心收据上标明的数额。其实收银机也是同样的道理，一开始发明的时候，它只是一个盒子，用来将店主的收入和店员的荷包分开。我们想把这种模式复制到数字化的世界中，用带签名的收据，将数字化价值的发行者约束在一套与用户签订的治理协议上。

我们还要走得更远。首先，为了实现完备的约束力，Alice 的初始授权也要包含在记录中。因此收据将包含所有的证据，即包括用户的意图，也包括服务者的响应行动；因此，它能成为这个事件的 *决定性记录*（dominating record）。这也意味着，最高效的记录保存策略就是丢掉所有的历史记录，仅仅保证带签名收据的安全。

这种支配既影响发行者，也影响用户，使我们能实现下述原则：

*用户与发行者所掌握的信息是同样多的*。

因为发行者把带签名的收据发回给了两个用户，所以，对每一个事件，所有三方都拥有同样的决定性记录。因为大量减少了由信息差导致的问题，支撑成本也大大降低。

其次，我们在该收据中绑定了一个签过名的发行合约，称为 “*李嘉图式合约*” [<sup>8</sup>](#note-8)。这一发明是通过 “*消息摘要*” 这种独一无二的凭证，将签过名的文档与签过名的收据安全地关联起来（又是通过密码学来实现的）。它为记账的单位、发行物的性质、发行人所作的条款、条件和承诺，以及发行者的身份，都强有力地绑定在一起。

最终，有了这些步骤，我们可以实现又一条原则：

*收据即是事务*。

在带签名的收据所组成的完整记录中，用户的意图得到了表达，也得到了服务器响应的完全确认。所有这些都由数字签名来保证数据的完整、无篡改。所以，像审计员这样的观察者可以比对两组数据并验证签名。


## 以带签名的收据作为簿记系统

收据即事务的原则日益凸显出其重要性。我们的客户端软件在设计上也贯彻了这一原则，从而简化记账系统，提供更高的可靠性。但问题依然存在，例如，客户端软件丢失收据并因此使余额统计出错。但是，一旦设计者将收据即事务视为首要原则，这些问题就都能迎刃而解。

### **单式记账**

为了根据一组相关收据计算余额，或呈现事务历史记录，我们需要基于收据集合动态构建账簿。这就相当于将带有签名的收据作为单式记账系统的基础。事实上，簿记由原始收据衍生而来，这就带来了一个问题：是否要保存这些账簿。

我们可以从关系数据库的原则中找到答案。根据 *第四范式*（译者注：数据库正规化中用到的一种形式），我们存储主要记录（在此语境下就是收据集合），并动态构建衍生记录和会计账簿 [<sup>9</sup>](#note-9)。

### **复式记账**

身为发行者的 Ivan 也遇到了同样的问题。服务器必须根据受影响的账簿中的可用余额接受每一笔新事务。因此，Ivan 需要找到一种方法来高效使用这些账簿。由于收据和账簿（每个用户账户都有一个账簿）数量庞大，这些收据和账簿都将保存下来（与第四范式截然相反）。将具有关联性的收据集合和复式账簿结合起来会有帮助。

在服务器的架构中，Alice 和 Bob 各自会被赋予一个账簿。按照惯例，我们会将这些账簿记作负债。然后，收据会被放到另一个单独的账簿中记作资产。Alice 和 Bob 之间的每笔事务都有一个逻辑上对应的条目（contra entry），然后在服务器账户中的 3 个地方显示。不过，资产端的数据仍会保持第四范式的形式，因为资产端的条目被推导出来时，每一对条目都来自资产端的一个条目（译者注：即收据）。

展开来说， Alice 或 Bob 所用的客户端软件，（愿意做得高级一些就）可以采用同样的方法。在这种极端情况下，条目保存在三个不同的地方，而且每个地方都有可能存在三个记录。

### **三式记账**

带数字签名的收据、可明确表达的对一笔事务的完整授权，对复式记账法构成了巨大威胁，至少从概念层面来说是这样。数字签名这一密码学发明为收据提供了强有力的证明，并将记账问题缩小到收据存在与否的问题。这一问题的解决方案就是共享记录 —— 让每个主体都持有一个正确的副本。

如果严格依照关系数据库理论，复式记账法已然成了多余的。根据第四范式，它已经被排除在标准之外。然而，这更多是从理论而非实践上来说的。在我们所构建的软件系统中，复式记账法和三式记账法同时存在、协同工作。

这就导致成对的复式条目通过中心化的收据列表相互关联。每个事务都有 3 个条目。每个记账主体都要保存 3 个条目，如果考虑到事务所涉及的 3 个参与方，就变成了 9 个条目。

这就是我们所说的 *三式记账法*。虽然带有数字签名的收据在信息方面占据优势，但是在处理方面处于劣势。复式记账法弥补了三式记账法在处理方面的不足，因此二者更适合协同工作。从这个意义上来说，三式记账法是一种进步，而非一场革命。

## 软件方面的考虑因素

从软件和数据角度来说，目前还没有制定一个明确的条目布局，这最终可能会成为短期实现问题之一。带有签名的收据可能会形成一个天然的资产方对应账户（contra account），或者形成一个独立的非账簿清单、化作一个记账系统及其资产记录和负债记录的基础。

基于收据构建账簿会产生审计问题，收据丢失时会产生标准化问题。这些问题都是未来研究的方向。

值得一提的是，签署收据的技术既可以使用私钥签名，也可以使用纠缠消息摘要签名。相应的技术是否具有足够高的安全性则取决于业务环境。

## 主体的角色

请注意，在上述三式记账法的设计中，Alice 和 Bob 都是具有一定独立性的主体。由此可见，三式记账法不仅可以作为记账系统，还可以作为数字现金系统。

这一设计并没有脱离会计专业，而是引入数字现金来代替公司记账。如果公司或其它管理实体的记账系统被重塑为数字现金（或内部货币）系统，则经验表明相关组织会从中受益。

虽然这一系统的核心看起来与记账系统并无差别，但是每个部门的账簿都变成了数字现金账户。各部门不再需要在制定预算上耗费太多精力，因为它们可以控制自己的资金。基本的治理控制权依然掌握在会计部门手中，因为该部门是记账系统的运行方，而且资金只能在组织内部使用。会计部门可能会充当做市商的角色，将内部货币付款兑换成外部货币付款来支付给外部供应商。

我们已经小规模运行了该系统。该系统不仅没有出现效率低下的问题，还大幅降低了协调成本。账单和工资都不再使用传统货币支付。许多交易都是通过内部货币转账处理的。在组织边缘，正式主体和非正式主体进行内外部货币兑换。文书工作大量减少，因为货币系统的记录已经足够可靠，即使在事件发生多年后，也能快速解决问题。

虽然内部货币的创新不属于本文的讨论范围，但是它们可以回答一个显而易见的问题：为什么这种三式记账法设计源于数字现金，又与企业界息息相关。

## 商业模式

Todd Boyle 从互联网时代小型企业需求的角度探究了这一问题，并得出了相同的结论 —— 三式记账法 [<sup>10</sup>](#note-10)。他的前提是：

1. 主要的需求不是记账或支付本身，而是交换模式 —— 复杂的交易模式；
2. 小型企业负担不起采取这类模式的大型复杂系统的成本；
3. 小型企业不会将自己锁定在专有框架中。

在此基础上，Boyle 的结论是，小型企业需要一个提供公平访问权限的共享存储库。从根本上来说，这个库类似于记录事务条目的传统复式分类账【“GLT”—— General Ledger-Transaction（总帐-交易）】，然而它的条目是动态且共享的。

举例来说，Alice 创建了一个事务，她将这个事务输入她的软件。每个 GLT 事务都需要注明她的外部对手方 Bob 的名字。当她公布这个事务时，她的软件会将其存入她的本地 GLT，并提交至共享存储库服务的 GLT。

然后，共享事务存储库（STR，Shared Transaction Repository）会将这个事务转发给 Bob。Bob 和 Alice 存储该事务的句柄（handle）作为索引或桩（stub），由 STR 存储完整的事务。 

Boyle 的想法在逻辑上与 Grigg 和 Howland 的想法类似，尽管二者的出发点不同（STR 就等同于上文提到的 Ivan），观点也不完全相同。Grigg 和 Howland 的想法仅限于付款、数量的准确性以及如何利用密码学来保障安全性。Boyle 则着眼于更广泛的事务模式，并证明了如果我们可以提取核心共享数据并将生成一条共享记录，STR 就可以协调这些事务。Boyle 的关注点在于事务的经济实质。

## 发票

想象一个简单的发票开具流程。Alice 创建了一个发票并通过自己的软件（GLT）发布出去。由于她已经在发票上注明了对手方是 Bob，GLT 会自动将该发票转发给 Ivan（STR），再由 Ivan 转发给 Bob。这时，Bob 需要决定是接受还是拒绝。如果 Bob 接受了，他的软件就会发送一条接受消息给 Ivan。STR 就会生成一条“已接受发票”记录来代替之前的“待确认发票”记录，并发布到 3 个地方。在（支付条款规定的）相应时间，Bob 会发布一个单独的事务来支付该发票。这在运作上很大程度类似单独的事务，直接链接至原始发票。

由于 Bob 的付款链接至发票，且发票是包含在三个记账系统中三个条目内的实时事务，我们或许能够通过已更新发票记录来引用付款活动。当付款完成时，新的记录会再度替换掉之前的未付款记录，并发布给 3 个参与方。

##  事务模式

我们可以编写软件来促进并监控该流程以及类似流程。如果付款系统具有足够的灵活性并与用户需求相结合，我们就有可能在收据层面将上述发票与付款本身合并。从这个角度来看，带有签名的收据所提供的李嘉图式合约是所有通用模式中最简单的一种。我们认为 “收据即事务” 这一狭隘的理论可以扩展为 “发票即事务”。

在商业世界中，每一个事务都不是孤立的，而是有模式的。例如，要约（offer）与承诺（acceptance）构成一个较宽泛的事务，但是很少覆盖整个履约和付款周期。即使有了带有采购订单消息的付款，客户也要等待履约。

关于这些事务模式已经有了大量研究和文献成果。ebXML 业务流程工作组等标准制定团体已经采用了这些模式，并称之为“商业交易”。然而，如今我们所做的是将这些事务分解成原子。这就是我们目前的方向。

## 三式记账法的必备条件

三式记账法的实现会在不断的演化过程中支撑这些事务模式。显然，复式记账法已经不足以支撑这些模式，因为一旦参与方超过 1 个，这个框架就会失败。虽然复式记账法不适用于网络，并且无法满足商业需求，但是三式记账法没有得到广泛理解，它对基础设施的要求也没有得到高度认可。

以下是我们认为重要的必备条件 [<sup>11</sup>](#note-11) [<sup>12</sup>](#note-12)：

1. **强假名性，这是最起码的。**由于事务模式中有很多循环，系统必须支持参与者之间存在清晰的关系。这至少需要具有李嘉图式合约或 AADS 特性的署名架构。（这是一个明确的要求，但是本文篇幅有限，不作深入讨论。）
2. **条目签名**。为了中和各参与方之间互相施加的威胁，我们需要一个机制来封存并确认基础数据。这就是签名，我们要求所有条目都能携带数字签名（上文要求 1 将要求我们使用公钥签名）。
3. **消息传递**。该系统从根本上来说是一种消息传递系统，与网络上大多数基于连接的架构形成鲜明的对比。Boyle 早就认识到，通用消息传递特性是一大关键。在 2001 至 2004 年间 [<sup>13</sup>](#note-13)，Systemics 就提议并将这个特性构建到了李嘉图合约中。
4. **条目扩张和迁移**。消息的每个新版本都代表一个将要更新或添加的条目。当每个消息添加到之前的会话时，已存储条目需要扩张并吸收新的信息，同时保留其它特性。
5. **本地条目存储和报告**。条目的持久存储和响应可得性。实际上，这是典型的会计总分类账，至少从存储的角度来说是这样。它需要经过一些调整才能处理更加灵活的条目，而且其报告功能会变得更加重要，因为该功能会在需求或实时基础上进行内部协调。
6. **整合硬支付**。贸易的效率不可能高于支付的效率。也就是说，支付部分的效率必须与其他部分一样高；在实践中，这也意味着支付系统必须内置在架构层。
7. **集成应用层的消息服务**。与协议底层的消息服务（见要求 1）不同，Alice 和 Bob 还必须能够磋商。因为绝大多数的模式都围绕着主体之间的基本沟通。建立更好的支付和发票机制并不能替代沟通和谈判的机制。这个概念可能在 SWIFT 系统上表现得最明显：SWIFT 从头到尾只是一个消息系统，负责分发支付的指令。

## 结论

复式簿记法提供了事务意图和来源的证据，使我们有办法能区分无心之失和欺诈。而带签名的收据这一金融密码学创新提供了同样的好处，因此挑战了复式记账长达 800 年的统治地位。实际上，从证据的角度来看，（因为数字签名的一系列技术属性）带签名的收据比复式账本的记录强大得多。

严格比较起来，带签名的收据还是有一些弱点。首先，在三式记账法的李嘉图式实例中，收据可能会丢失，或被有意移除，因此我们要强调一个原则是 “*条目即事务*（the entry is the transaction）”。结果是，三个主体会自己负责保管签过名的条目，作为最重要的事务记录。

其次，三式记账需要用到软件，没办法像复式记账那么方便。出于这个原因，我们将收据中包含的信息扩展成为一组复式的账本，如此一来，在每一个节点上我们都可以两全其美：既能获得带签名收据的证据力量，又能获得复式记账的便利性和本地的交叉查验能力。

这些解决方案都将带签名的收据与复式记账揉合在一起。最后，我们获得了一个三乘三的逻辑序列，我们认为 “三式记账” 一词可以准确描述此一对旧式记账方法的改进。

### **引入主体**

为了得到三式记账所有的好处，我们必须将记账系统拓展到为其他主体服务，并赋予他们直接发起事务的能力。也就是说，我们通过向主体发放内部货币 [<sup>14</sup>](#note-14)，使他们成为系统的利益相关者。使用电子现金系统来做公司的账户，可以让电子现金在整体上替代使用账簿和部门预算的会计系统；并且，也能通过对带签名收据的使用，为验证和审计中心化的账户系统打开大门。

### **解决欺诈**

实现了所有这些之后，治理流程将可得到极大的便利。账户将变得难以更改，也会变得透明很多。我们认为，有了这些技术，那些千奇百怪的丑闻和治理失败就都不会发生了：共同基金的丑闻将有清晰的事务踪迹可供审计，因此被推迟标记（late timing）的事务以及被扭曲或丢弃的事务都可以得到清晰的定位，或被完全消除 [<sup>15</sup>](#note-15)。美国正在上演的、叫做 “股票门” 的丑闻也不会再发生，因为带签名的收据可以揭露为操纵市场而伪造的股票和价值。类似地，如果账户都围绕着很透明的电子现金组织起来，辅之以公开、不能删减的带签名的收据（可作为无形账户（88888）的证明），巴林银行也不会在投资银行界消失。更直接的 “追踪金钱流向”的治理，也将能揭开那些令人眼花缭乱、但在经济上毫无意义的交换活动的面纱，扼杀安然公司丑闻这样的案件。



## 脚注

<p id="note-1">注 1：本论文的一份初稿将 Todd Boyle 也列为作者之一，但后来他请求撤销署名，因为我们有许多意见不同。</p>
<p id="note-2">注 2：Friar Luca Pacioli, <i><a href="http://www.acsac.org/2001/papers/110.pdf">Summa de Arithmetica, Geometria, Proportioni et Proportionalita</a></i> 1494, Venice</p>
<p id="note-3">注 3：Ian Grigg "<a href="http://www.financialcryptography.com/mt/archives/000442.html">The Twilight Zone</a>", Financial Cryptography blog 16th April 200。</p>
<p id="note-4">注 4：“纠缠”的概念可见于：Petros Maniatis and Mary Baker, "Secure History Preservation through Timeline Entanglement," Proc. 11th USENIX Security Symposium, August 2002。</p>
<p id="note-5">注 5：David Chaum, "Achieving Electronic Privacy," Scientific American, v. 267, n. 2 Aug 1992。</p>
<p id="note-6">注 6：Robert A. Hettinga "<a href="http://www.shipwright.com/rants/rant_02.html">The Book-Entry/Certificate Distinction</a>" 1995, Cypherpunks。</p>
<p id="note-7">注 7：Gary Howland "<a href="http://www.systemics.com/docs/sox/overview.html">Development of an Open and Flexible Payment System</a>" 1996, Amsterdam, NL.。</p>
<p id="note-8">注 8：Ian Grigg "<a href="http://nakamotoinstitute.org/the-ricardian-contract/">The Ricardian Contract</a>," First IEEE International Workshop on Electronic Contracting (WEC) 6th July 2004</p>
<p id="note-9">注 9：E.F. Codd, "A Relational Model of Data for Large Shared Data Banks," Comm. ACM 13 (6), June 1970, pp. 377-387</p>
<p id="note-10">注 10：Todd Boyle, "<a href="http://ledgerism.net/GLT-GLR.htm">GLT and GLR: conceptual architecture for general ledgers</a>", Ledgerism.net, 1997-2005</p>
<p id="note-11">注 11：Todd Boyle, "<a href="http://www.ledgerism.net/STR.htm">STR software specification</a>", Goals, 1-5. This section adopts that numbering convention.</p>
<p id="note-12">注 12：Ian Grigg, various design and requirements documents, Systemics, unpublished</p>
<p id="note-13">注 13：变成和设计的主要部分是由 Edwin Woudt （第一个 demo、SOX 层 和 UI） 和 Jeroen van Gelderen （消息传递的客户端架构）完成的。</p>
<p id="note-14">注 14：使用内部货币而非记账系统并不是一个新点子，只不过最近才付诸实践，见：Ian Grigg, <a href="http://iang.org/rants/systemics_psd.html">How we raised capital at 0%, saved our creditors from an accounting nightmare, gave our suppliers a discount and got to bed before midnight</a>. Informal essay (rant), 7 Jul 2003。</p>
<p id="note-15">注 15：James Nesfield and Ian Grigg "<a href="http://iang.org/papers/mutual_funds.html">Mutual Funds and Financial Flaws</a>", U.S. Senate Finance Subcommittee 27th January, 2004。</p>

（完）